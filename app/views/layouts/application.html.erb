<!DOCTYPE html>
<html>
<head>
  <title>PlusOne</title>
  <meta charset="UTF-8">
  <meta name = "viewport" content="initial-scale=1.0", width="device-width">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
  <%= stylesheet_link_tag 'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?v=3?key=#{Figaro.env.google_maps_api}" %>
  <%= javascript_include_tag "https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" %>

  <%= csrf_meta_tags %>
</head>

<body class="<%= controller_name %> <%= action_name %>">

<div id="nav">
  <ul class="nav-links">

    <%= link_to root_path class: "home-link" do %>
      <li class="nav-icons"><%= image_tag("home.png") %></li>
    <% end %>

    <% if current_user %>
      <%= link_to events_path do %>
        <li class="nav-icons location-link"><%= image_tag("location.png") %></li>
      <% end %>

      <%= link_to new_event_path do %>
        <li class="nav-icons new-event-link"><%= image_tag("plus.png") %></li>
      <% end %>

      <%= link_to :logout, method: :post do %>
        <li class="nav-icons logout-link"><%= image_tag("x.png") %></li>
      <% end %>

      <%= link_to user_path(current_user.id) do %>
        <li class="nav-icons profile-link"><%= image_tag("gear.png") %></li>
      <% end %>

      <button type="button" class="js-menu-trigger sliding-panel-button">
        <img src="https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/menu-white.png" alt="Menu Icon">
      </button>




      <nav class="js-menu sliding-panel-content">
        <ul class="notifications-menu">
          <br><li><h1>Notifications</h1></li><hr>

          <li><% current_user.rsvps.each do |rsvp| %>
            <% if rsvp.status = "pending" %>
              <li>You have been accepted into <%= rsvp.event.event_name %><hr></li>
            <% else %>
              <p>No notifications for you.</p>
            <% end  %>
          <% end %>
          </li>

          <li><% current_user.created_events.each do |event| %>
            <% event.rsvps.each do |rsvp| %>
              <% if rsvp.status = "pending" %>
                <li><%= rsvp.user.username %> wants to join your event <%= rsvp.event.event_name %><br>
                  <button>Accept</button>
                  <button>Decline</button>
                <hr></li>
              <% else %>
                <p>No notifications for you.</p>
              <% end  %>
            <% end %>
          <% end %>
          </li>
          <script>
          var listItems = document.getElementsByTagName("li");
            for (var i = 0; i < listItems.length; i++) {
              listItems[i].onclick = function() {this.parentNode.removeChild(this);}
          }
          </script>

        </ul>
      </nav>

      <div class="js-menu-screen sliding-panel-fade-screen"></div>

    <% else %>
      <%= link_to new_user_path do %>
        <li class="nav-icons signup-link"><%= image_tag("signup.png") %></li>
      <% end %>

      <%= link_to :login do %>
        <li class="nav-icons login-link"><%= image_tag("login.png") %></li>
      <% end %>
    <% end %>
  </ul>
</div>

  <div class="container">
    <p id="notice"><%= flash[:notice] %></p>
    <p id="alert"><%= flash[:alert] %></p>
  </div>

  <div class="yield">
    <%= yield %>
  </div>



</body>
</html>
